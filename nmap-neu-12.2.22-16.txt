  //@liv-in-sky 2022  12.2.-16:28

 // DAS WIDGET IN DER VIS
 // das Standard html-Widget wird genutzt in der VIS - dazu den DP javascript.x.Tabellen@Liv.TestTabelleVIS.NMAPTabelleVIS als binding angeben d.h.
 // im html-teil des widgets wird dier daten punkt in geschweiften klammern angegeben z.B. {javascript.x.Tabellen@Liv.TestTabelleVIS.NMAPTabelleVIS}

 // @ts-ignoreMD
 let   braucheEinVISWidget=true;                          // immer true 
 let   dpVIS="NMAPTabelleVIS"                             // DAtenpunkt für Tabelle
 let   dpJSON="NMAPTabelleJSON"                           // hier nicht genutzt- immer false
 let   braucheHostDaten=true;                            // Liste für Ausdruck
 let   braucheMaterialDesignWidget=false;                 // bei true wird ein html-tabelle für MD Widget in einen dp geschrieben - sortierung nur nach namen möglich
 let   braucheMaterialDesignWidgetList=false;             // bei true wird ein html-tabelle für MD Widget in einen dp geschrieben - sortierung nur nach namen möglich
 let mySchedule="  1,31 * * * * ";                         // 

 //ZUSÄTZLICH VARIABLEN

 let sortierenEIN=true;
  let mitSearch=true;
  let welcheSortierung=1;                                 // Startsortierung - je nach spalte  1: name; 2: ip; 3:kat; 4:mac
 const schalterUmrahmung="0"                              //wenn überschriften buttons sind , den rahmen mit 0 wegmachen 
 let tabletDoppelHilfe=true;                              // aud tablett geht kein doppelklick - es erschein ein weiterer button in der seitenleiste


 let flexboxView=false;                                  // startet im flexbox modus - keine tabelle

 //VON ALTEM SCRIPT

 let   pfadFuerBilder="/vis.0/armin/img/"                       // PFAD zu den bildern, die in die vis geladen wurden/
 const domainName="fritz.box";                  // domainname in der fritzbox definiert
 const ipbereich="192.168.178.0/24";           //  gilt nicht für windows
 const dnsServer="192.168.178.1"               // gilt nicht für windows
 let mysortiereClient=2;                     //1 nach client 2 nach ip 
 const waitTime=550;                        // falls längere zeit keine daten kommen - diesen wert erhöhn um 5000 (ms)
 const lastZellColorSetting="lightgreen"      // farbe der zusammenfassung in der letzten zelle der tabelle 
 const oerationSystemchange=false;              // false ist linux, true ist windows
 const onlyWinEthernetIF="eth0"                // nur windows über befehl "nmap --iflist" herausfinden
 const farbeNichtErreichbar="#819FF7" //"#FFBF00";         // farbe für devices, die gerade nicht online sind
 const styleNichtErreichbar="i";             // möglich i=schräg, b ist fett und span ist normal - nur eines  davon !!!
 const kuerzungNamen=23;                      // länge der namen kürzen
 const materialD_IP_erreichbar="#D8D8D8";        // material design farbe der ip adresse bei erreichbaren klient
 const materialD_IP_nichtErreichbar="#F7819F";    // material design farbe der ip adresse bei nicht erreichbaren klient
 const bildergroesse=30;                       // bilder für kategory - die bilder werden unter kat in den devices  eingetragen - es  muss ein standard.png im pfad liegen - ansonsten müssen die bilder
                                               // den namen der "kat" haben z.b.: server.png oder sonoff.png

//hier eintragen für die übersetzung der standardnamen - aliase - rechte seite wird statt linker  angezeigt - die beispiele kann man raus löschen
// BITTE AUF DIE KOMMAs ACHTEN
const myDeviceNames={ "192.168.178.24"  :"HF Küche Licht",     // ein leeres array wird so erzeugt: const myDeviceNames=[]; alte version - kompatibel
                      "192.168.178.118" :"Echo Beige",
                      "192.168.178.100" :"Echo Plus",
                      "192.168.178.50"  :"Echo Dot Zimmer",
                      "192.168.178.68"  :"HF Desk Haupt"

}

const myDeviceNamesNew= [{"ip" : "192.168.178.10", "name" : "Proxmox", "link" : "https://192.168.178.10:8006/", "kat":"server", "linkFirstName":"WEB"},
                         {"ip" : "192.168.178.157", "name" : "sqltulla", "link" : "http://192.168.178.157:8181/settings", "kat":"server", "linkFirstName":"TAUTULLA" },
                         {"ip" : "192.168.178.145", "name" : "pi-hole", "link" : "http://192.168.178.145/admin", "kat":"server", "linkFirstName":"WEB" },
                         {"ip" : "192.168.178.59", "name" : "iobroker", "link" : "http://192.168.178.59:8081/#tab-objects", "kat":"server","linkFirstName":"OBJ", "morelinks":[{"TAB":"http://192.168.178.59:8081/#tab-logs"},{"INS":"http://192.168.178.59:8081/#tab-instances"}] },
                         {"ip" : "192.168.178.199", "name" : "NAS-FILE-Server", "link" : "", "kat":"server" },
                         {"ip" : "192.168.178.46", "name" : "Broadlink Pro", "link" : "", "kat":"broadlink" },
                         {"ip" : "192.168.178.61", "name" : "Broadlink Mini", "link" : "", "kat":"broadlink" },
                         {"ip" : "192.168.178.96", "name" : "TOnline Receiver", "link" : "", "kat":"magenta" },
                         {"ip" : "192.168.178.182", "name" : "Xiaomi Keller", "link" : "", "kat":"esp" },
                         {"ip" : "192.168.178.197", "name" : "Xiaomi Wohnung", "link" : "", "kat":"esp" },
                         {"ip" : "192.168.178.72", "name" : "AXHD60", "link" : "http://192.168.178.72", "kat":"server" },
                         {"ip" : "192.168.178.173", "name" : "ESP-KAMERA1", "link" : "http://192.168.178.173", "kat":"esp", "linkFirstName":"WEB" },
                         {"ip" : "192.168.178.117", "name" : "ESP-SWITCH-CAM1", "link" : "http://192.168.178.117", "kat":"sonoff", "linkFirstName":"WEB" },
                         {"ip" : "192.168.178.174", "name" : "ESP-KAMERA2", "link" : "http://192.168.178.174", "kat":"esp", "linkFirstName":"WEB" },
                          {"ip" : "192.168.178.172", "name" : "ESP-SWITCH-CAM2", "link" : "http://192.168.178.172", "kat":"sonoff", "linkFirstName":"WEB" },
                         {"ip" : "192.168.178.175", "name" : "ESP-KAMERA3", "link" : "http://192.168.178.175", "kat":"esp", "linkFirstName":"WEB" },
                         {"ip" : "192.168.178.171", "name" : "ESP-SWITCH-CAM3", "link" : "http://192.168.178.171", "kat":"sonoff", "linkFirstName":"WEB" },
                         {"ip" : "192.168.178.191", "name" : "ESP-KAMERA4", "link" : "http://192.168.178.191", "kat":"esp", "linkFirstName":"WEB" },
                          {"ip" : "192.168.178.135", "name" : "ESP-SWITCH-CAM4", "link" : "http://192.168.178.135", "kat":"sonoff", "linkFirstName":"WEB" },
                         {"ip" : "192.168.178.192", "name" : "ESP-KAMERA5", "link" : "http://192.168.178.192", "kat":"esp", "linkFirstName":"WEB" },
                         {"ip" : "192.168.178.83", "name" : "ESP-SWITCH-CAM5", "link" : "http://192.168.178.83", "kat":"sonoff", "linkFirstName":"WEB" },
                         {"ip" : "192.168.178.73", "name" : "MediaPadT5", "link" : "", "kat":"tablet" },
                         {"ip" : "192.168.178.148", "name" : "Echo Dot 3", "link" : "", "kat":"echo_dot3" },
                         {"ip" : "192.168.178.29", "name" : "TrekStor13", "link" : "", "kat":"tablet" },
                         {"ip" : "192.168.178.26", "name" : "P5200", "link" : "", "kat":"tablet" },
                         {"ip" : "192.168.178.151", "name" : "FireTab7", "link" : "", "kat":"tablet" },
                          {"ip" : "192.168.178.44", "name" : "GalaxyS2", "link" : "", "kat":"tablet" },
                         {"ip" : "192.168.178.201", "name" : "VPN Netzwerk", "link" : "", "kat":"vpn" },
                         {"ip" : "192.168.178.56", "name" : "FireHDStick", "link" : "", "kat":"firetvstick" },
                         {"ip" : "192.168.178.41", "name" : "FireTVStick", "link" : "", "kat":"firetvstick" },
                         {"ip" : "192.168.178.37", "name" : "FireTVStick1", "link" : "", "kat":"firetvstick" },
                         {"ip" : "192.168.178.33", "name" : "SonoffS26Alexa", "link" : "", "kat":"sonoff26" },
                         {"ip" : "192.168.178.189", "name" : "FireTVEthernet", "link" : "", "kat":"firetvstick" },
                         {"ip" : "192.168.178.124", "name" : "Galaxy-S9", "link" : "", "kat":"handygal" },
                         {"ip" : "192.168.178.28", "name" : "Google-Home-Mini", "link" : "", "kat":"googlemini" },
                         {"ip" : "192.168.178.81", "name" : "GalaxyTabA16", "link" : "", "kat":"tablet" },
                         {"ip" : "192.168.178.21", "name" : "GoSund 2 Matrix", "link" : "", "kat":"gosund111" },
                         {"ip" : "192.168.178.155", "name" : "GoSund 3 Freezer", "link" : "", "kat":"gosund111" },
                         {"ip" : "192.168.178.126", "name" : "Matrix Büro", "link" : "", "kat":"matrix" },
                         {"ip" : "192.168.178.168", "name" : "Matrix Küche", "link" : "", "kat":"matrix" },
                         {"ip" : "192.168.178.147", "name" : "MatrixTV", "link" : "", "kat":"matrix" },
                         {"ip" : "192.168.178.80", "name" : "MatrixCPU", "link" : "", "kat":"matrix" },
                         {"ip" : "192.168.178.150", "name" : "Gosund 1", "link" : "", "kat":"gosund111" },
                         {"ip" : "192.168.178.77", "name" : "SteckdoseAlexa", "link" : "", "kat":"fragezeichen" },
                         {"ip" : "192.168.178.235", "name" : "MotionEye", "link" : "http://192.168.178.235:8765/", "kat":"server", "linkFirstName":"EYE"  },
                         {"ip" : "192.168.178.142", "name" : "AdGuard", "link" : "http://192.168.178.142/", "kat":"server" },
                         {"ip" : "192.168.178.1", "name" : "DragonRoot", "link" : "http://192.168.178.1", "kat":"fritzbox", "linkFirstName":"WEB" },
                         {"ip" : "192.168.178.129", "name" : "WLEDRund", "link" : "http://192.168.178.129/", "kat":"server", "linkFirstName":"WEB"},
                         {"ip" : "192.168.178.132", "name" : "WLEDLang", "link" : "http://192.168.178.132/", "kat":"server", "linkFirstName":"WEB" },
                         {"ip" : "192.168.178.88", "name" : "DragonRoot-Dect", "link" : "http://192.168.178.88", "kat":"fritzbox" },
                         {"ip" : "192.168.178.74", "name" : "LGwebOSTV", "link" : "", "kat":"LG_TV_2" },
                         {"ip" : "192.168.178.139", "name" : "MCU Thermometer", "link" : "http://192.168.178.139", "kat":"esp" },
                          {"ip" : "192.168.178.140", "name" : "EASY1", "link" : "http://192.168.178.140", "kat":"sonoff", "linkFirstName":"WEB" },
                         {"ip" : "192.168.178.163", "name" : "EASY2", "link" : "http://192.168.178.163", "kat":"sonoff" , "linkFirstName":"WEB"},
                         {"ip" : "192.168.178.141", "name" : "BridgeSensateTemp", "link" : "", "kat":"sonoff" },
                         {"ip" : "192.168.178.101", "name" : "DashPlayboy", "link" : "", "kat":"" },
                         {"ip" : "192.168.178.86", "name" : "DashSakrotan", "link" : "", "kat":"" },
                         {"ip" : "192.168.178.95", "name" : "Sonoff2-Distance", "link" : "http://192.168.178.95", "kat":"sonoff" }, 
                         {"ip" : "192.168.178.14", "name" : "Plex", "link" : "http://192.168.178.14:32400/web/index.html", "kat":"server" , "linkFirstName":"WEB" },
                         {"ip" : "192.168.178.156", "name" : "EchoShow5", "link" : "", "kat":"Echo-Show-5" }
                         ]
 
 var symbolOK="✔️";     // auch möglich: ="✅"   🟩   ✔️  🌎
var symbolKO="🔵"           // ist in let symbolSchalter    //"🔔";     //z.b. auch "<font color=\"red\"><b>X</b>" für ein rotes kreuz  oder : ="❌"  ⚪   🟢 ⚫ ⭕  🔴 🔵  🚫 ⏱ 💀 👍 👎 📑 💲 👀 😡 🟥 ⬜ 🧊 💬 🗑️ 🔔
var symbolWARN="ℹ️";    // ="⚠️" oder info: "ℹ️"
var symbolKO_MD="🟥"    // ist in let symbolSchalter   
var symbolLink="🌎";
var externalOhneInfo=false;  //noch nicht integriert

 //---------------------------------------

//HIER DIE SPALTEN ANZAHL DEFINIEREN - jede Spalte einen Wert - in diesem Beispiel sind es 3 - es MÜSSEN in allen Arrays die GLEICHE Anzahl für die Werte sein
let htmlFeld=        ["NAME","IP","ONLINE","KAT","MAC"];                   // GLEICHE ANZAHL !! NAME/ÜBERSCHRIFT DER SPALTE
let val=             ["true","true","true","true","true"];                 // bei false wird spalte ausgeblendet// GLEICHE ANZAHL !! SPALTE ANZEIGEN/AUSBLENDEN UND HIER SIND DIE  WERTE, DIE IN DER SCHLEIFE GEFILTERET WERDEN -  jeder val[x] muss unten in der schleife gesetzt werden !!
let Feld1lAlign=     ["left","center","center","center","center"];         // GLEICHE ANZAHL !! AUSRICHTUNG IN DER SPALTE
let htmlSpalte1Weite=["0px","0px","0px","0px","0px"];                      // GLEICHE ANZAHL !! BREITE DER SPALTE, wenn "0px" auto
let schalterInSpaltenUeberschrift=[true,true,true,true,true,true,true,true];    // WENN BUTTONS INSTALLIERT WERDEN - sonst false
let symbolSchalter=              ["na","&check;","&cross;","&#128472;","⚪"];               //ONLINE SYMBOLE         // SYMBOLE DER BUTTONS 
//-----------------------------------

//Symbole für Tabelle z.b.: ⚪  ⚫ ⭕  🔴 🔵 ⏱ 💀 👍 👎 📑 💲 👀 🔹 ✅ ❌ ⚠️ mehr: https://emojiterra.com/de/ oder https://unicode-table.com/de/html-entities/

//hier werden die styles für die tabelle definiert
//ÜBERSCHRIFT ÜBER TABELLE
const htmlUberschrift=true;                             // mit Überschrift über der tabelle
const htmlSignature=true;                               // anstatt der Überscghrift eine signature: - kleiner - anliegend
const htmlFeldUeber='NMAP IP Netzwerk';                // für Überschrift und Signature falls htmlUberschrift und htmlSignature ist true
const htmlFarbUber="white";                              // Farbe der Überschrift
const htmlSchriftWeite="normal";                         // bold, normal - Fettschrift für Überschrift
const htmlUEberFontGroesse="18px";                       // schriftgröße überschrift
//SEITENLEISTE
const ichWillSeitenLeiste=true;                          // links einblenden einer Seitenleiste
const nameSeitenLeiste="N E T W O R K"
const breiteSeitenleiste=35;
const schriftGroesseSeitenleiste=18;
const abstandSeitentextVonOben=4;
const htmlFarbSeiteSchrift="white";
const htmlBackgroundFarbeSeitenliste="blue";
//BUTTON ÜBERSCHRIFT
const htmlBackgroundButtonUeberschrift="transparent";
//SUCHE
let bkgroundSearch=1;                                    //   hintergrund für suche-ergebnis und flexboxen    // 1: carbon; 2: iobroker; 3: colored bubbles;  4: gradient farben von htmlFarbTableColorGradient1; 5: gradient farben wie farbeUngeradeZeilen; 6: heller hintergrund
const sucheEin=true;
const sucheHoehe=25;
//MEHRERE TABELLEN NEBENEINANDER
let mehrfachTabelle=1;                                   // bis zu 3 Tabellen werden nebeneinander geschrieben-  verkürzt das Ganze, dafür etwas breiter - MÖGLICH 1,2,3 !!!
const trennungsLinie=1;                                // extra trennungslinie bei mehrfachtabellen - evtl auf 0 stellen, wnn htmlRahmenLinien auf none sind
const farbetrennungsLinie="#5590CA";                     // bei mehreren Tabellen nebeneinander wird ein Strich zw. den Tabellen gezogen
const htmlFarbTableColorUber="white"                     // Spalten-Überschrift in der tabelle - für die einzelnen Spalten //"#BDBDBD"; 
const htmlFarbZweiteTabelle="white";                     // Farbe der Spalten-Überschrift bei jeder 2.ten Tabelle        
//ÜBERSCHRIFT SPALTEN - OBERSTE ZEILE IN TAB
const UeberSchriftHoehe=40;                            // Überschrift bekommt mehr Raum - darunter und darüber - Zellenhöhe
const LinieUnterUeberschrift="1";                        // Liniehoehe nur unter Spaltenüberschrift  
const farbeLinieUnterUeberschrift="blue";               // LinienFarbe unter Spaltenüberschrift
const groesseUeberschrift=16; 
const UeberschriftStyle="normal"                         // möglich "bold"
const UeberschriftSpalten=true;                          // ein- oder ausblenden der spatlen-überschriften
//GANZE TABELLE
const abstandZelle="7";                                  // legt den abstand in den zellen zum rahmen fest
const zeilenAbstand=40;                                   // legt den abstand zwischen den zeilen fest
const farbeUngeradeZeilen="#2F2F2F";                     // Farbe für ungerade Zeilenanzahl - Hintergrund der Spaltenüberschrift bleibt bei htmlFarbTableColorGradient1/2 - bei "transparent" gewinnt htmlFarbTableColorGradient1
const farbeGeradeZeilen="#3c3c3c"//"#151515";            // Farbe für gerade Zeilenanzahl - Hintergrund der Spaltenüberschrift bleibt bei htmlFarbTableColorGradient1/2   - bei "transparent" gewinnt htmlFarbTableColorGradient2
let weite="750";                                        // Weite der Tabelle - verhindert das dynamische breiter werden, wenn werte unterschiedliche werte haben
let hoeheTabelle=600;
const zentriert=true;                                    // ganze tabelle zentriert im html Widget - muss in pixel angegeben werden oder "auto"
const backgroundAll="#000000";                           // Hintergrund für die ganze Seite - für direkten aufruf oder iqontrol sichtber - keine auswirkung auf vis-widget
const htmlSchriftart="Ubuntu-Regular"                    // "Jura-DemiBold"   //"RobotoCondensed-Bold"   //"Helvetica"; .....
const htmlSchriftgroesse="16px";                         // schriftgröße in den zellen
const rahmenBreite="1px";                                //mit 0 ist äußerer rahmen weg
//FELDER UND RAHMEN
const htmlFarbFelderschrift="#CBCBCA";                   // SchriftFarbe der Felder
const htmlFarbFelderschrift2="#CBCBCA";                  // SchriftFarbe der Felder für jede 2te Tabelle
const htmlGragient=[150,5,20];                          // einstellung des gradienten
const htmlFarbTableColorGradient1="#265686";             // Gradient - Hintergrund der Tabelle - Verlauffarbe
const htmlFarbTableColorGradient2="#5590CA";              // Gradient - Hintergrund der Tabelle - ist dieser Wert gleich Gradient1 gibt es keinen verlauf  
const htmlFarbTableBorderColor="grey";                   // Farbe des Rahmen - ist dieser gleich den gradienten, sind die rahmen unsichtbar
let htmlRahmenLinien="none";                             // Format für Rahmen: MÖGLICH: "none" oder "all" oder "cols" oder "rows"


// AB HIER NICHTS  ÄNDERN -------------------------------------------------------------------------------------------------
// AB HIER NICHTS  ÄNDERN -------------------------------------------------------------------------------------------------
// AB HIER NICHTS  ÄNDERN ---------------------------------erst wieder ab Zeile 134----------------------------------------

let borderHelpBottum;
let borderHelpRight;
let htmlcenterHelp;
let htmlcenterHelp2;

let trHelperClass=" ";
let htmlTabUeber4;
let htmlTabUeber2;
let htmlTabUeber2_1;
let searchMe;
let htmlSeitenleiste;
let htmlTabStyle;
let htmlTabUeber3="";       //wird in function writeHTML gesetzt - wegen umschalten views

let buttonScript; //scripte am ende einfügen

let bkgDiv;   //background scroll-div
let scrollBar; //dünne scrollbar

let aktiv=0; let inaktiv=0;
let myButtonUeberschrift; //not in use
let htmlZentriert;   //css
let einmalAbstand; //seitenleiste
let myScann="";

if(String(htmlRahmenLinien)=="rows") {borderHelpBottum=1;borderHelpRight=0;}
if(String(htmlRahmenLinien)=="cols") {borderHelpBottum=0;borderHelpRight=1;}
if(String(htmlRahmenLinien)=="none") {borderHelpBottum=0;borderHelpRight=0;}
if(String(htmlRahmenLinien)=="all")  {borderHelpBottum=1;borderHelpRight=1;}
zentriert ? htmlcenterHelp="auto" : htmlcenterHelp="left";
zentriert ? htmlcenterHelp2="center" : htmlcenterHelp2="left";

if(weite=="auto") {weite="100%"} else {weite=String(Number(weite)*mehrfachTabelle)}

 
  makeMyCSS();
  makeMySearch_Seitenleiste();
  makeMyVisScripte();

//------------------------------------------------------
if ( !(val.length == Feld1lAlign.length && htmlSpalte1Weite.length == htmlFeld.length && val.length == htmlFeld.length) || (mehrfachTabelle<1 || mehrfachTabelle>3) ) 
      { log("Anzahle der Definitions Arrays sind ungleich ODER mehrfachTabelle ist falsch - Script wurde gestoppt !!!","error");
          // @ts-ignore
          stopScript();}
let braucheEinJSON=false;                               // bei true wird ein html-tabelle in einen dp geschrieben - siehe nächste zeile
let langeGesamt=0; 
let htmlTabUeber="";
let htmlOut="";
let mix;
let counter;
//let makeJsonWidget;
let myObject=[];
let myArrMac=[]
const dpPrefix = "javascript."+ instance +".";

var rootcount=true;
var myObjOld=[];
var myJsonWidget=[]; 
var myJsonWidget2=[];

var valButton=1;
var myObj;

 //HIER SIND DIE  WERTE, DIE IN DER SCHLEIFE GEFILTERET WER%DEN - Jede spalte einen wert - jeder valx muss in dieser schleife gesetzt werden !!
 var val1; var val0; var val2;let val3;
 var json1; var json2; var json3; var json4; var json5; var json6;
 let myObjExtra=[];
 let laeuftSchon=false;
 var hostDaten="";

 let mitAlphabet=false;

needDP();

var myData="xxxxx"; 
let myArr=[];

async function writeHTML(mitDatenGet){
     aktiv=0;  inaktiv=0;
 laeuftSchon=true;

 let seitenLeistenTest="";
 //log(flexboxView.toString())
 flexboxView ? htmlTabUeber3=`</tr></thead><tbody></tbody></table><div class="divFlexBoxen${dpVIS}">` :
              htmlTabUeber3=`</tr></thead><tbody class="scrollContent${dpVIS}" > `;
 let htmlTabUeber1=htmlTabUeber4

let helperLeerzeile=""
//let makeJsonWidget=[];
htmlOut="";
counter=-1;

 //--------------------------------------------------------------------------------------------------------------------------------------------------
 //---------hier kommt eure schleife rein counter++, tabelleBind() und tabelleFinish() müssen so integriert bleiben !!!------------------------------
 //---------alle val[x] werte müssen von euch bestimmt werden - val[0],val[1],val[2] !!!-------------------------------------------------------------
 //--------------------------------------------------------------------------------------------------------------------------------------------------

     if(mitDatenGet) { myData="xxxxx";}
     
          hostDaten="";
          myArr=[];
          myArrMac=[]
          myObjExtra=[];
          myObj=[]
          

 async function holeData() {
      return new Promise((resolve) => {
          if(mitDatenGet) {
if(oerationSystemchange == false){
 exec("sudo -u root /usr/local/bin/nmap -sP --dns-servers "+dnsServer+" "+ipbereich  , async function (error, result, stderr) {
    myData=result
  //  setState("0_userdata.0.Tabellen.IPDeviceERROR", result)
     //console.log(result);
     resolve()
});} else {

 exec((['"C:\\\\Program Files (x86)\\\\Nmap\\\\nmap" ','-sPR  -e ',onlyWinEthernetIF,' --dns-servers ',dnsServer,' ',ipbereich].join('')), function (error, result, stderr) {
    myData=result
     resolve()
});} } else { resolve()}
 });
 }
//if(!mitDatenGet) {}

await holeData().then( async function () {  //})
//let timeout = setTimeout(function () {
 // myData=getState("0_userdata.0.Tabellen.DeviceIPFake").val       //   FÜR TEST
 ////////////////////////////////log(myData)
 //log(mitDatenGet)
 //log(myData)
  if (!myData.includes("xxxx") && myData.length>70) {

 // myArr=myData.match(/for\s+([A-Za-z0-9-_]+).f[^(]+\((\d+.\d+.\d+.\d+)\)|(fritz.\w+)\s+\((\d+.\d+.\d+.\d+)\)|(\d+.\d+.\d+.\d+)$/g)

//let myArrMac=myData.match(/MAC Address:\s+(.+?:.+?:.+?:.+?:.+?:.+?)\s.*/gm);


myArr=myData.match(/for\s+([A-Za-z0-9-_]+).f[^(]+\((\d+\.\d+\.\d+\.\d+)\)|(fritz\.\w+)\s+\((\d+\.\d+\.\d+\.\d+)\)|(\d+\.\d+\.\d+\.\d+)$/gm)

 if(myArr!=null) {

    
let myTimeScanArr = ['na'];

 myTimeScanArr=myData.match(/(scanned in) ([0-9]+\.[0-9]+ seconds)/g); //log(myTimeScan)
//log(myTimeScanArr[0])
myScann=myTimeScanArr[0] 

let myArrSingleMac=[]
  myArrMac=myData.match(/MAC Address:\s+(.+?:.+?:.+?:.+?:.+?:..)/gm);
//  myArrMac=myData.match(/MAC Address:\s+(.+?:.+?:.+?:.+?:.+?:..)/gm);
//log(myArrMac[0])
if(myArrMac==null) { for(let zz=0;zz<myArr.length;zz++){myArrSingleMac.push("missing")  }} else {

for (let aa=0;aa<myArrMac.length;aa++) {myArrSingleMac.push(myArrMac[aa].replace("MAC Address: ",""))}
//log(myArrSingleMac[0])
myArrSingleMac.push("mac iobroker")}



 let var1; let var2; let var3; let varOhneName=[];let valMAC;
  myObj=[]
 for(var i=0;i<myArr.length;i++) {
     var1="na"; var2="na";
     var1=myArr[i].replace(/(for .+) \(\d+\.\d+\.\d+\.\d+\)/,"$1") 
     var1=var1.replace(/(.+)\(.+\)/," $1")
     var2=myArr[i].replace(/for .+ \((\d+\.\d+\.\d+\.\d+)\)/,"$1");//log(var2)
     var2=var2.replace(/.+\((.+)\)/,"$1")
     valMAC=myArrSingleMac[i];
     varOhneName=myArr[i].match(/^(\d+\.\d+\.\d+\.\d+)$/) 
     if (varOhneName!=null) {var1=varOhneName[0];var2=varOhneName[0]}
     var3="true";


   let help=[var1.trim(),var2.trim(),var3,valMAC]
   if (!(var1=="na" || var2=="na")) myObj.push(help)
   if (true) {/* myObjOld= getState("0_userdata.0.Tabellen.IPDeviceERROR").val */ 
                   myObjOld.push(help);    
                   }
 }
//log("vor await")
 await needDP2(myObjOld)
 
                  await Sleep(1500); 
                  myObjOld=await getData("javascript." + instance + ".Tabellen@Liv."+dpVIS+".Device_Collection")   


//log("++++++++++++++++++ "+myObj.toString())


    
    let varhelp1; let varhelp2; let varhelp3="true"; let varMAChelp   //neue erkannt geräte zu datenbank hinzufügen
   for (var i=0;i<myObj.length;i++){ 
        //  log("kommen vom myObject: "+myObjOld[i][1]+" mit: "+myObjOld[i][0])
            if (!myObjOld.toString().includes(myObj[i][1]))  {  varhelp1=myObj[i][0].trim() ; varhelp2=myObj[i][1]; varhelp3="true"; varMAChelp=myObj[i][3];
                                                     let help=[varhelp1,varhelp2,varhelp3,varMAChelp]; /*log("+++++++!!!+++++++++help "+help.toString())*/
                                                    if (!(varhelp1.indexOf("scanned")>-1)) myObjOld.push(help)               
                                      }                       }

   for (var i=0;i<myObjOld.length;i++){                // ist gerät noch da ???
      //  if (i>0 && i<10)  log("-----"+myObjOld[i][0]+" alles: ") ;     if (i>0 && i<2) log(myObj.toString())
            if (!myObj.toString().includes(myObjOld[i][1]))  {  varhelp1=myObjOld[i][0].trim() ; varhelp2=myObjOld[i][1]; varhelp3="false"; varMAChelp=myObjOld[i][3];
                                                     let help=[varhelp1,varhelp2,varhelp3,varMAChelp]; /*if (i>=0 && i<80)  log("+++++++???+++++++++help "+help.toString())*/
                                                     myObj.push(help)               
                                      }                      }
  
    // log("------------------------------------------------"+myObjOld.toString())
//log(mysortiereClient.toString())
     if (braucheMaterialDesignWidget || braucheMaterialDesignWidgetList) mysortiereClient=1



 /*if (!rootcount)*/  setState("javascript." + instance + ".Tabellen@Liv."+dpVIS+".Device_Collection", myObjOld)
 ///////////////////////////log("myObject ------- "+myObj.length.toString()+"---- ")
  // setState("0_userdata.0.Tabellen.IPDeviceERROR", myObj.toString())   // zur fehlersuche
         for(var i=0;i<myObj.length;i++) {            // hier eigene schleife definieren und den wert counter++ nicht vergessen  !!!

           counter++;                                       // SEHR WICHTIG - MUSS IN JEDER SCHLEIFE INTEGRIERT SEIN
         //  log(myObj[i][0].toString())
           val0=myObj[i][0].replace("for","").trim()
           val0=val0.replace("."+domainName,"")
           val0=val0.replace(/[(,)]/g,"")
           val1=myObj[i][1]
           val1=val1.replace(/[(,)]/g,"")
           if (myObj[i][3]!=undefined) {val3=myObj[i][3].replace("MAC Address: ","");} else{val3= " - "} 

       //  log(val0+" --- "myDeviceNamesNew[].ip)

for (var index in myDeviceNames) {                   //ersetze mit aliasnamen
                               //log(index)
                                if ((val1.trim()).match(index.trim()) && val1.trim().length == index.trim().length) {val0=myDeviceNames[index];
                                                                                                                     
                                //log(val0+" - "+index)
                                  } } 
let helperIP=""
let helperlink=""
let helperkat="standard"
for (var index in myDeviceNamesNew) {                   //ersetze mit aliasnamen
//helperkat="standard";
                               //log(index)
                                if ((val1.trim()).match(myDeviceNamesNew[index].ip) && val1.trim().length == (myDeviceNamesNew[index].ip).length) {
                                    
                                                                                                                  val0=myDeviceNamesNew[index].name; 
                                                                                                                  
 
                                                                                                                //   if (val0.length>=(kuerzungNamen)+2)  val0=val0.substring(0,kuerzungNamen)+" ...";
                                                                                                                  // helperIP=val0 ;  //log(val0)
                                                                       if ( myDeviceNamesNew[index].hasOwnProperty("kat") ) {if (myDeviceNamesNew[index].kat!="") {helperkat=myDeviceNamesNew[index].kat; } else{helperkat="standard"}}
                                                                                                                   if (myDeviceNamesNew[index].link!="") {helperlink=myDeviceNamesNew[index].link; 
                                                                       myDeviceNamesNew[index].hasOwnProperty("linkFirstName") ? helperIP=helperIP+` <a href="${helperlink}" target="_blank"><button style="font-size: 75%; background: ${farbeNichtErreichbar}; color:${htmlFarbFelderschrift}">${myDeviceNamesNew[index].linkFirstName}</button></a>` 
                                                                                                                               : helperIP =helperIP+` <a style="text-decoration:none;" href="${helperlink}" target="_blank"> ${symbolLink}</a>` 
                                                                         
                                                                       if(myDeviceNamesNew[index].hasOwnProperty("morelinks")) {//log(JSON.stringify(myDeviceNamesNew[index].morelinks))
                                                                     
                                                                       for(let o=0;o<myDeviceNamesNew[index].morelinks.length;o++) {
                                                                                                                                    let test=JSON.parse(JSON.stringify(myDeviceNamesNew[index].morelinks))
                                                                                                                                    let key1=Object.keys(test[o])[0]
                                                                                                                                    //log(    Object.keys(test[o])[0]    );
                                                                                                                                  //  log(   test[o][key1]  );
                                                                                                                                    helperIP=helperIP+ ` <a href="${test[o][key1]}" target="_blank"><button style="font-size: 75%; background: ${farbeNichtErreichbar}; color:${htmlFarbFelderschrift}">${Object.keys(test[o])[0]}</button> </a>`         //`<button onclick="window.location.href =${test[o][key1]};">${Object.keys(test[o])[0]}</button>`                        //` ${Object.keys(test[o])[0]}<a style="text-decoration:none;" href="${test[o][key1]}" target="_blank"> ${symbolLink}</a>`
                                                                                                                                       }  
                                                                       }
                                                                
                                                                      }
                                                                 
                         
                                  } }                                   

             if (val0.length>=(kuerzungNamen)+2)  val0=val0.substring(0,kuerzungNamen)+" ..." 
                  val0=val0+helperIP;          

      
           
           var val2help=myObj[i][2];



   if (mysortiereClient==555){ //  not in use
      // log(val0+val1+val2help)
        if(val0=="scanned in") {val[2]=symbolWARN;val[0]="<font color=\""+lastZellColorSetting+"\"><i>"+" Anzahl "+counter+"</i>"; 
        let valer=val1.replace(/.* (um.*)/,"$1");
                               val[1]=val1.replace(/(.*) um.*/,"$1");
                               
                               val[1]="<font color=\""+lastZellColorSetting+"\"><i>"+val[1]+"</i>"}
       

           if (val2help=="false") {val[2]=symbolKO;
 
                                   val[0]=("<font color=\""+farbeNichtErreichbar+"\"><"+styleNichtErreichbar+">")+val0+ "<\/"+styleNichtErreichbar+">";
                                   val[1]=("<font color=\""+farbeNichtErreichbar+"\"><"+styleNichtErreichbar+">")+val1+ "<\/"+styleNichtErreichbar+">";}  else{val[2]=symbolOK}        
              tabelleBind(); }                              // bei true wird ein html-tabelle in einen dp geschrieben - siehe nächste zeile
                else {} // not in use
         
     let help=[val0.trim(),val1,val2help,val3,helperkat];myObjExtra.push(help);
    //}
}; //Schleifen Ende - je nach schleifenart muss hier etwas geändert werden !!!!!!!!!
     var valLink=""; var valKat="";  
    
     if (mysortiereClient==1){   //Name
        
         myObjExtra.sort(function (alpha, beta) {
             if ((alpha[0].toUpperCase()).trim() > (beta[0].toUpperCase()).trim())
                return 1;
             if ((beta[0].toUpperCase()).trim() > (alpha[0].toUpperCase()).trim())
                return -1;
             return 0;
            });} 

 if (mysortiereClient==5){  //mac
        myObjExtra.sort(function (alpha, beta) {
             if (alpha[3] > beta[3])
                return 1;
             if (beta[3]> alpha[3])
                return -1;
             return 0;
            });}
          
  if (mysortiereClient==3){ //online
          myObjExtra.sort(function (alpha, beta) {
             if (alpha[2] > beta[2])
                return 1;
             if (beta[2]> alpha[2])
                return -1;
             return 0;
            });}

    if (mysortiereClient==2){ 
         myObjExtra.sort( function( a, b )   {
	                                      	a = a[1].split( '.' );
	                                      	b = b[1].split( '.' );
	                                    	for( var i = 0; i < a.length; i++ )	{
		                                 	if( ( a[i] = parseInt( a[i] ) ) < ( b[i] = parseInt( b[i] ) ) )
		                         		return -1;	else if( a[i] > b[i] )
		                            	return 1;}  	return 0;} );}

                                                                                     //  }

         if (mysortiereClient==4){   //kat
        
         myObjExtra.sort(function (alpha, beta) {
             if ((alpha[4].toUpperCase()).trim() > (beta[4].toUpperCase()).trim())
                return 1;
             if ((beta[4].toUpperCase()).trim() > (alpha[4].toUpperCase()).trim())
                return -1;
             return 0;
            });}                                     
 

counter=-1;
            var valLink=""; var valKat="";     
  //   log(myObjExtra.length)
    // log(myObjExtra)
          for(var i=0;i<myObjExtra.length;i++) {
           
            if(myObjExtra[i][2]=="true")  aktiv++
             // if(val2help=="false") inaktiv++   ;log(myObjExtra[i][2])
              if(myObjExtra[i][2]=="false") inaktiv++ 
                json4="standard"
              
                json6="";
                 let valhelping="";
                counter++
                val[0]=myObjExtra[i][0]//.replace(/(^.*?) <a.*/,"$1")
                val[4]=myObjExtra[i][3]
                json1=myObjExtra[i][0] ;// if(i>20 && i<30) log(val[0])
                json2=val[1]=myObjExtra[i][1] ;
                 val2help=myObjExtra[i][2] ;
                let bildHelper=myObjExtra[i][4];
                val[3]="<img src=\""+pfadFuerBilder+myObjExtra[i][4]+".png \" height=\""+bildergroesse+"\"px width=\""+bildergroesse+"\"px>";

                             
                         
                            if (val2help=="false" ) {json3=val[2]=symbolSchalter[2]; json5="red";
                                   val[0]=("<font color=\""+farbeNichtErreichbar+"\"><"+styleNichtErreichbar+">")+val[0]+ "<\/"+styleNichtErreichbar+"></font>";
                                   val[2]=("<font color=\""+farbeNichtErreichbar+"\"><"+styleNichtErreichbar+">")+val[2]+ "<\/"+styleNichtErreichbar+"></font>";
                                   val[1]=("<font color=\""+farbeNichtErreichbar+"\"><"+styleNichtErreichbar+">")+val[1]+ "<\/"+styleNichtErreichbar+"></font>";
                                   val[4]=("<font color=\""+farbeNichtErreichbar+"\"><"+styleNichtErreichbar+">")+val[4]+ "<\/"+styleNichtErreichbar+"></font>"; }  else{json3=val[2]=symbolSchalter[1];   json5="green";} 
             
        

                                            if (val2help) val[0]=val[0]+valhelping ; // link

                  flexboxView ? flexboxBind(bildHelper,val2help) : tabelleBind(); 
               
                if (braucheMaterialDesignWidget || braucheMaterialDesignWidgetList) {
                   if (val2help=="false") {json3=symbolSchalter[2]; }
                  makeJsonWidget(json1,json2,json3,json4,json5,json6);}

                    
            }
           
 //-------------------------------------------------------------------------------------------------------------------------------------------------
 //--------------------------------------------------Ende der schleife------------------------------------------------------------------------------
 //-------------------------------------------------------------------------------------------------------------------------------------------------

       // AB HIER NICHTS ÄNDERN - tabelle fertigstellen
         
  if (braucheMaterialDesignWidgetList) {   setState("javascript." + instance + ".Tabellen@Liv."+dpVIS+".IPDevices_MD_List",JSON.stringify(myJsonWidget2)); }
  if (braucheMaterialDesignWidget) {setState("javascript." + instance + ".Tabellen@Liv."+dpVIS+".IPDevices_MD_Table",JSON.stringify(myJsonWidget)); }
   myJsonWidget2=[];


       let timeout = setTimeout(function () {
                                               flexboxView ? flexboxFinish() :  tabelleFinish(); 
                                            //  if (braucheEinFile) {writeFile(home, path ,htmlOut, function (error) { /* log('file written');*/  });}
                                              if (braucheHostDaten) {for(var i=0;i<myObjExtra.length;i++) {  if (myObjExtra[i][0]!="xxxxscanned"){
                                                                                                             hostDaten=hostDaten+myObjExtra[i][1]+`\t`+myObjExtra[i][0]+';' }}}
                                               setState("javascript." + instance + ".Tabellen@Liv."+dpVIS+".HostDaten",hostDaten); //log(hostDaten)
                                            }, 2000); 
    
//        }  else {log("no Array","warn"); log(myArr.toString())} //Ende Array falsch
//       } else {log("no Data","warn")} // ende daten falsch
      //  rootcount=false;
 
//  laeuftSchon=false;
//  } )                                          

 //-------------------------------------------------------------------------------------------------------------------------------------------------
 //--------------------------------------------------Ende der schleife------------------------------------------------------------------------------
 //-------------------------------------------------------------------------------------------------------------------------------------------------

 
    htmlTabUeber2=""
   
 //SpaltenÜberschrift
for (let ue=0;ue<htmlSpalte1Weite.length;ue++) {  
                                                if (!schalterInSpaltenUeberschrift[ue] ) {  htmlTabUeber2=htmlTabUeber2.concat("<td  style=\"color:"+htmlFarbTableColorUber+"\">"+htmlFeld[ue]+"</td>")} 

                    else {let valButton="javascript." + instance + ".Tabellen@Liv."+dpVIS+".Spalte"+ue;
                     if(ue==1) {htmlTabUeber2=htmlTabUeber2.concat("<th class=\"myTHclass"+dpVIS+" toDel"+dpVIS+"\" >"+
                                                                   "<span class=\"mySpan"+dpVIS+"\"></span><button class=\"myButt"+dpVIS+"\" style=\" border-radius: 4px; border:"+schalterUmrahmung+"px solid; background-color\: "+htmlBackgroundButtonUeberschrift+"\; color: "
                                                                   +htmlFarbTableColorUber+"; font-family: "+htmlSchriftart+"; font-size :"+groesseUeberschrift+"px; text\-align:left\" value=\"toggle\" onclick=\"setOnOtherValue\(\'"+valButton+"\')\">"
                                                                   +htmlFeld[ue]+"</button>"+" <font style=\"; font-weight: normal; font-size :"+groesseUeberschrift+"; color: "+htmlFarbTableColorUber+"; font-family: "+htmlSchriftart+";\" >&ensp;&ensp;&ensp;("+aktiv+"\/"+(aktiv+inaktiv)+")</th>")
                                                                   } else{
                                        
                                        if(ue==0) { myScann=(myScann.replace("scanned in ","")).replace("seconds","s"); htmlTabUeber2=htmlTabUeber2.concat("<th class=\"myTHclass"+dpVIS+" toDel"+dpVIS+"\" >"+
                                                                   "<span class=\"mySpan"+dpVIS+"\"></span><button class=\"myButt"+dpVIS+"\" style=\" border-radius: 4px; border:"+schalterUmrahmung+"px solid; background-color\: "+htmlBackgroundButtonUeberschrift+"\; color: "
                                                                   +htmlFarbTableColorUber+"; font-family: "+htmlSchriftart+"; font-size :"+groesseUeberschrift+"px; text\-align:left\" value=\"toggle\" onclick=\"setOnOtherValue\(\'"+valButton+"\')\">"
                                                                   +htmlFeld[ue]+"</button>"+" <font style=\"; font-weight: normal; font-size :"+groesseUeberschrift+"; color: "+htmlFarbTableColorUber+"; font-family: "+htmlSchriftart+";\" >&ensp;&ensp;&ensp;("+myScann+")</th>")

                                        } else{
                                        htmlTabUeber2=htmlTabUeber2.concat("<th class=\"myTHclass"+dpVIS+" toDel"+dpVIS+"\">"+""
                                                                    +"<span class=\"mySpan"+dpVIS+"\"></span><button class=\"myButt"+dpVIS+"\" style\=\" border-radius: 4px; border:"+schalterUmrahmung+"px solid; background-color\: "+htmlBackgroundButtonUeberschrift+"\; color: "
                                                                    +htmlFarbTableColorUber+"; font-family: "+htmlSchriftart+"; font-size :"+groesseUeberschrift+"px; text-align:left\" value=\"toggle\" onclick=\"setOnOtherValue\(\'"+valButton+"\')\">"
                                                                    +htmlFeld[ue]+"</button></th>");
                                                                    
                                                                     } // sonst
                                                                      } //ue!=last 
                       }}
 
//SpaltenÜberschrift bei mehrfachtabelle
 
 if (!flexboxView){ htmlTabUeber2_1=""
for (let ue=0;ue<htmlSpalte1Weite.length;ue++) { let valButton="javascript." + instance + ".Tabellen@Liv."+dpVIS+".Spalte"+ue;
    if(ue==htmlSpalte1Weite.length) {htmlTabUeber2_1=htmlTabUeber2_1.concat("<th class=\"myTHclass"+dpVIS+" toDel"+dpVIS+"\" >"+""
                                                                    +"<span class=\"mySpan"+dpVIS+"\"></span><button class=\"myButt"+dpVIS+"\" style\=\" border-radius: 4px; border:"+schalterUmrahmung+"px solid; background-color\: "+htmlBackgroundButtonUeberschrift+"; color: "
                                                                    +htmlFarbTableColorUber+"; font-family: "+htmlSchriftart+"; font-size :"+groesseUeberschrift+"px; text-align:left\" value=\"toggle\" onclick=\"setOnOtherValue\(\'"+valButton+"\')\">"
                                                                    +htmlFeld[ue]+"</button></th>")}
    else{ if(ue==0){htmlTabUeber2_1=htmlTabUeber2_1.concat("<th class=\"myTHclass"+dpVIS+" toDel"+dpVIS+"\" >"+""
                                                                    +"<span class=\"mySpan"+dpVIS+"\"></span><button class=\"myButt"+dpVIS+"\" style\=\" border-radius: 4px; border:"+schalterUmrahmung+"px solid; background-color\: "+htmlBackgroundButtonUeberschrift+"; color: "
                                                                    +htmlFarbTableColorUber+"; font-family: "+htmlSchriftart+"; font-size :"+groesseUeberschrift+"px; text-align:left\" value=\"toggle\" onclick=\"setOnOtherValue\(\'"+valButton+"\')\">"
                                                                    +htmlFeld[ue]+"</button></th>")


    } else{
     htmlTabUeber2_1=htmlTabUeber2_1.concat("<th class=\"myTHclass"+dpVIS+" toDel"+dpVIS+"\" >"+""
                                                                    +"<span class=\"mySpan"+dpVIS+"\"></span><button class=\"myButt"+dpVIS+"\" style\=\" border-radius: 4px; border:"+schalterUmrahmung+"px solid; background-color\: "+htmlBackgroundButtonUeberschrift+"; color: "
                                                                    +htmlFarbTableColorUber+"; font-family: "+htmlSchriftart+"; font-size :"+groesseUeberschrift+"px; text-align:left\" value=\"toggle\" onclick=\"setOnOtherValue\(\'"+valButton+"\')\">"
                                                                    +htmlFeld[ue]+"</button></th>")}}  } 

 }else { htmlTabUeber2_1="";for (let ue=0;ue<htmlSpalte1Weite.length;ue++) { htmlTabUeber2_1=htmlTabUeber2_1.concat("<th class=\"myTHclass"+dpVIS+" toDel"+dpVIS+" emptyFlex2_1"+dpVIS+"\">"+htmlFeld[ue]+"</th>")}
     
 /*    for (let ue=0;ue<htmlSpalte1Weite.length;ue++) { 
     htmlTabUeber2_1=htmlTabUeber2_1.concat("<th class=\"myTHclass"+dpVIS+" toDel"+dpVIS+"\" >"+""
                                                                    +"<button class=\"myButt"+dpVIS+"\" style\=\" border-radius: 4px; border:"+schalterUmrahmung+"px solid; background-color\: "+htmlBackgroundButtonUeberschrift+"; color: "
                                                                    +htmlFarbTableColorUber+"; font-family: "+htmlSchriftart+"; font-size :"+groesseUeberschrift+"px; text-align:left\" value=\"toggle\" onclick=\"setOnOtherValue\(\'"+valButton+"\')\">"
                                                                    +htmlFeld[ue]+"</button></th>")}*/
 }                                                                  
                                                                    

  htmlTabUeber="";

  switch (mehrfachTabelle) { 
    case 1: htmlTabUeber=htmlTabUeber1+htmlTabUeber2+htmlTabUeber3;  break;
    case 2: htmlTabUeber=htmlTabUeber1+htmlTabUeber2+htmlTabUeber2_1+htmlTabUeber3; break;
    case 3: htmlTabUeber=htmlTabUeber1+htmlTabUeber2+htmlTabUeber2_1+htmlTabUeber2_1+htmlTabUeber3; break;
    case 4: htmlTabUeber=htmlTabUeber1+htmlTabUeber2+htmlTabUeber2_1+htmlTabUeber2+htmlTabUeber2_1+htmlTabUeber3; break;
   };   
   if (!UeberschriftSpalten) {htmlTabUeber=""}

    flexboxView ? flexboxFinish() :  tabelleFinish(); 
       if (braucheEinJSON ) {setStateDelayed("javascript." + instance + ".Tabellen@Liv."+dpVIS+".JSONVis",JSON.stringify(makeJsonWidget),1000 )}
  ////////    
      }  else {log("no Array","warn"); log(myArr.toString())} //Ende Array falsch
       } else {log("no Data","warn")} // ende daten falsch
      //  rootcount=false;
 
  laeuftSchon=false;
  } ) 
///////////


} // function ende
 
 //MAIN:
  
schedule(mySchedule,  function () { 
 if(!laeuftSchon) writeHTML(true);
 // if (braucheEinFile) {writeFile(home, path ,htmlOut, function (error) { /* log('file written');*/  });}
 }); 
 setTimeout(function () { if(!laeuftSchon) writeHTML(true);  }, 2550);                                 

  function tabelleBind(){
   
    switch (mehrfachTabelle) { 

    case 1: if(counter%2==0)   {htmlOut=htmlOut+"<tr class=\"myclasstr_gerade"+dpVIS+" \">";
                                for(let u=0;u<val.length;u++){ htmlOut=htmlOut.concat("<td class=\"myclasstd_normal"+dpVIS+" toDel"+dpVIS+"\">"+val[u]+"</td>"); // style=\"width:"+htmlSpalte1Weite[u]+"\" 
                                                             }  htmlOut=htmlOut.concat("</tr>");   break;
 
                                } else   {htmlOut=htmlOut+"<tr class=\"myclasstr_ungerade"+dpVIS+" \">";
                                          for(let u=0;u<val.length;u++){ htmlOut=htmlOut.concat("<td class=\"myclasstd_normal"+dpVIS+" toDel"+dpVIS+"\">"+val[u]+"</td>"); //style=\"width:"+htmlSpalte1Weite[u]+"\" 
                                                                       }  htmlOut=htmlOut.concat("</tr>");   break;
                                }
    
    case 2: if(counter%4==0){  if(counter%2==0)  {htmlOut = htmlOut+"<tr class=\"myclasstr_gerade"+dpVIS+" \">";
                                                  for(let u=0;u<val.length;u++){ if(u<val.length-1) {htmlOut=htmlOut.concat("<td class=\"myclasstd_normal"+dpVIS+" toDel"+dpVIS+"\">"+val[u]+"</td>");} else
                                                                               {htmlOut=htmlOut.concat("<td class=\"myclasstd_trennungslinie"+dpVIS+"\" style=\" border-right:"+trennungsLinie+"px solid "+farbetrennungsLinie+ ";\">"+val[u]+"</td>")}
                                                                               }  
                                                                            
                                 } else { for(let u=0;u<val.length;u++){ htmlOut=htmlOut.concat("<td class=\"myclasstd_normal"+dpVIS+" toDel"+dpVIS+" toDel"+dpVIS+"\" style=\"color:"+htmlFarbFelderschrift2+"\">"+val[u]+"</td>");
                                                                       }  htmlOut=htmlOut.concat("</tr>");  } break;
                            } else {
                              if(counter%2==0)  {htmlOut=htmlOut+"<tr class=\"myclasstr_ungerade"+dpVIS+" \">";
                                                 for(let u=0;u<val.length;u++){  if(u<val.length-1) {htmlOut=htmlOut.concat("<td class=\"myclasstd_normal"+dpVIS+" toDel"+dpVIS+"\">"+val[u]+"</td>");} else
                                                                              {htmlOut=htmlOut.concat("<td class=\"myclasstd_trennungslinie"+dpVIS+" toDel"+dpVIS+"\" style=\" border-right:"+trennungsLinie+"px solid "+farbetrennungsLinie+ ";\">"+val[u]+"</td>")}
                                                                              }  
                                 } else {        for(let u=0;u<val.length;u++){ htmlOut=htmlOut.concat("<td class=\"myclasstd_normal"+dpVIS+" toDel"+dpVIS+"\" style=\"color:"+htmlFarbFelderschrift2+"\">"+val[u]+"</td>");
                                                                              }  htmlOut=htmlOut.concat("</tr>");  }  break;}

    case 3: if(counter%2==0)  {  if(counter%3==0 ) {htmlOut = htmlOut+"<tr class=\"myclasstr_gerade"+dpVIS+" \">";
                                                    for(let u=0;u<val.length;u++){if(u<val.length-1) {htmlOut=htmlOut.concat("<td class=\"myclasstd_normal"+dpVIS+" toDel"+dpVIS+"\">"+val[u]+"</td>");} else
                                                                                 {htmlOut=htmlOut.concat("<td class=\"myclasstd_trennungslinie"+dpVIS+" toDel"+dpVIS+"\" style=\" border-right:"+trennungsLinie+"px solid "+farbetrennungsLinie+ ";\">"+val[u]+"</td>")}
                                                                                                         }  
                                } else { if(counter%3==1)  {for(let u=0;u<val.length;u++){  if(u<val.length-1) {htmlOut=htmlOut.concat("<td class=\"myclasstd_normal"+dpVIS+" toDel"+dpVIS+"\" style=\"color:"+htmlFarbFelderschrift2+"\">"+val[u]+"</td>");} else
                                                                                                               {htmlOut=htmlOut.concat("<td  style=\" border-right: "+trennungsLinie+"px solid "+farbetrennungsLinie+ "; color:"+htmlFarbFelderschrift2+"\">"+val[u]+"</td>")}
                                                                                                         }  
                                                           } else  { for(let u=0;u<val.length;u++){  htmlOut=htmlOut.concat("<td class=\"myclasstd_normal"+dpVIS+" toDel"+dpVIS+"\">"+val[u]+"</td>");
                                                                                                  }  htmlOut=htmlOut.concat("</tr>");  } }  break;
                              } 
                              else {
                                 if(counter%3==0 )  {htmlOut = htmlOut+"<tr class=\"myclasstr_ungerade"+dpVIS+" \">";
                                                    for(let u=0;u<val.length;u++){ if(u<val.length-1) {htmlOut=htmlOut.concat("<td class=\"myclasstd_normal"+dpVIS+" toDel"+dpVIS+" toDel"+dpVIS+"\">"+val[u]+"</td>");} else
                                                                                                      {htmlOut=htmlOut.concat("<td class=\"myclasstd_trennungslinie"+dpVIS+" toDel"+dpVIS+" toDel"+dpVIS+"\" style=\" border-right:"+trennungsLinie+"px solid "+farbetrennungsLinie+ ";\">"+val[u]+"</td>")}
                                                                                                         }  
                                                                                                         
                              } else{ if(counter%3==1 )  { for(let u=0;u<val.length;u++){ if(u<val.length-1) {htmlOut=htmlOut.concat("<td class=\"myclasstd_normal"+dpVIS+" toDel"+dpVIS+"\" style=\"color:"+htmlFarbFelderschrift2+"\">"+val[u]+"</td>");} else
                                                                                                             {htmlOut=htmlOut.concat("<td  style=\" border-right: "+trennungsLinie+"px solid "+farbetrennungsLinie+ "; color:"+htmlFarbFelderschrift2+"\">"+val[u]+"</td>")}
                                                                                                         }  
                                                          } else {        for(let u=0;u<val.length;u++){ htmlOut=htmlOut.concat("<td class=\"myclasstd_normal"+dpVIS+" toDel"+dpVIS+"\">"+val[u]+"</td>");
                                                                                                       }  htmlOut=htmlOut.concat("</tr>"); } } break;
                              }                                        


                                 
         } //switch ende

 }

  function tabelleAusbessern() {         // bessert mei mehrfachtabellen die nicht vollen zeilenn aus - bevor die unterüberschriften kommen

 switch (mehrfachTabelle) {
         
        case 1:    break;
        case 2:    let helpMehrfach="</td>";
                   for(let w=0;w<val.length;w++){helpMehrfach=helpMehrfach.concat("<td>&ensp;</td>")};helpMehrfach=helpMehrfach.concat("</tr>")
                   if(counter%2==0)  htmlOut = htmlOut.replace(/<\/td>$/, helpMehrfach);
                   break;
        case 3:   let helpMehrfach2="</td>";
                  for(let w=0;w<val.length;w++){helpMehrfach2=helpMehrfach2.concat("<td>&ensp;</td>")};helpMehrfach2=helpMehrfach2.concat("</tr>")
                  if(counter%3==2)  htmlOut = htmlOut.replace(/<\/td>$/, "</td></tr>");
                  if(counter%3==1)  htmlOut = htmlOut.replace(/<\/td>$/, helpMehrfach2);
                  let helpMehrfach3="</td>";
                  let helpMehrfach31="";for(let w=0;w<val.length;w++){helpMehrfach31=helpMehrfach31.concat("<td>&ensp;</td>")}
                  for(let w=0;w<val.length;w++){if(w<val.length-1) {helpMehrfach3=helpMehrfach3.concat("<td>&ensp;</td>")} else
                                                          {helpMehrfach3=helpMehrfach3.concat("<td class=\"myclasstd_trennungslinie"+dpVIS+"\" style=\" border-right: "+trennungsLinie+"px solid "+farbetrennungsLinie+"\">&ensp;</td>"+helpMehrfach31)}
                                                    };helpMehrfach3=helpMehrfach3.concat("</tr>")        
                  if(counter%3==0)  htmlOut = htmlOut.replace(/<\/td>$/, helpMehrfach3);  break; }}

  function tabelleFinish() {

 switch (mehrfachTabelle) {
         
        case 1:    break;
        case 2:    let helpMehrfach="</td>";
                   for(let w=0;w<val.length;w++){helpMehrfach=helpMehrfach.concat("<td>&ensp;</td>")};helpMehrfach=helpMehrfach.concat("</tr>")
                   if(counter%2==0)  htmlOut = htmlOut.replace(/<\/td>$/, helpMehrfach);
                   break;
        case 3:   let helpMehrfach2="</td>";
                  for(let w=0;w<val.length;w++){helpMehrfach2=helpMehrfach2.concat("<td>&ensp;</td>")};helpMehrfach2=helpMehrfach2.concat("</tr>")
                  if(counter%3==2)  htmlOut = htmlOut.replace(/<\/td>$/, "</td></tr>");
                  if(counter%3==1)  htmlOut = htmlOut.replace(/<\/td>$/, helpMehrfach2);
                  let helpMehrfach3="</td>";
                  let helpMehrfach31="";for(let w=0;w<val.length;w++){helpMehrfach31=helpMehrfach31.concat("<td>&ensp;</td>")}
                  for(let w=0;w<val.length;w++){if(w<val.length-1) {helpMehrfach3=helpMehrfach3.concat("<td>&ensp;</td>")} else
                                                          {helpMehrfach3=helpMehrfach3.concat("<td class=\"myclasstd_trennungslinie"+dpVIS+"\" style=\" border-right: "+trennungsLinie+"px solid "+farbetrennungsLinie+"\">&ensp;</td>"+helpMehrfach31)}
                                                    };helpMehrfach3=helpMehrfach3.concat("</tr>")        
                  if(counter%3==0)  htmlOut = htmlOut.replace(/<\/td>$/, helpMehrfach3);  break; }
      
         var htmlUeber=    "<p  class=\"divWeiten"+dpVIS+"\" style=\"color:"+htmlFarbUber+"; font-family:"+htmlSchriftart+"; font-size: "+htmlUEberFontGroesse+"; font-weight:"+htmlSchriftWeite+ "\">"+htmlFeldUeber+"&ensp;&ensp;Last Update: "+formatDate(getDateObject((new Date().getTime())), 'SS:mm:ss')+"</p>"; 
         if(mitSearch) htmlUeber=htmlUeber+searchMe
         var htmlUnter= "<div class=\"divWeiten"+dpVIS+"\" style=\"margin-top: 10px; color:"+htmlFarbUber+"; height: 30px; font-family:"+htmlSchriftart+"; font-size: 85%; text-align: center;\" >"+htmlFeldUeber+"&ensp;&ensp;Last Update: "+formatDate(getDateObject((new Date().getTime())), "SS:mm:ss");"</div>";
         
         if (!htmlSignature) htmlUnter="";
              var htmlOutVIS="";
              if (htmlUberschrift) 
                 { zentriert ? htmlOutVIS=htmlZentriert+htmlUeber+htmlTabStyle+htmlTabUeber+htmlOut+"</tbody></table></div></div>"+htmlUnter+"</center>"+ buttonScript : htmlOutVIS=htmlUeber+htmlTabStyle+htmlTabUeber+htmlOut+"</tbody></table></div></div>"+htmlUnter+"</center>"+ buttonScript ;
             } else {
                zentriert ?  htmlOutVIS=htmlZentriert+htmlTabStyle+htmlTabUeber+htmlOut+"</tbody></table></div></div>"+htmlUnter+"</center>"+ buttonScript :  htmlOutVIS=htmlTabStyle+htmlTabUeber+htmlOut+"</tbody></table></div></div>"+htmlUnter+"</center>"+ buttonScript;
             }
                 

   // log("bin raus aus tabelleBind");
            if (braucheEinVISWidget)  setStateDelayed("javascript." + instance + ".Tabellen@Liv."+dpVIS+".HTMLTableVis", htmlOutVIS ,1000);
            setStateDelayed("javascript." + instance + ".Tabellen@Liv."+dpVIS+".Aktiv", aktiv ,1500);
            setStateDelayed("javascript." + instance + ".Tabellen@Liv."+dpVIS+".Inaktiv", inaktiv ,1500);
             setStateDelayed("javascript." + instance + ".Tabellen@Liv."+dpVIS+".Geamtanzahl", aktiv+inaktiv ,1500);
          

  var htmlUnter= "<div  style=\"color:"+htmlFarbUber+"; font-family:"+htmlSchriftart+"; height: 30px; font-size: 80%;  text-align: center; \" >"+htmlFeldUeber+"&ensp;&ensp;Last Update: "+formatDate(getDateObject((new Date().getTime())), "SS:mm:ss");+"</div>"

  if (!htmlSignature) htmlUnter="";
   var htmlEnd="</table>"+htmlUnter+"</div></body>";




 }


 function flexboxBind(bildHelper,online){

 let bildHelper2="";
 let divHelpi="";//log(online)
 if (online=="false") divHelpi=`style=\"border-color: black; background-image: linear-gradient(${htmlGragient[0]}deg,${htmlFarbFelderschrift} 10%, #434141 20%)\"`
   bildHelper!="" ? bildHelper2="<img src=\""+pfadFuerBilder+bildHelper+".png \" height=\""+bildergroesse+"\"px width=\""+bildergroesse+"\"px>" : bildHelper2="";
   if(val[4]=="missing") val[4]="";
   htmlOut=htmlOut+"<div class=\"divFlexBoxenEinzeln"+dpVIS+" divInFlex"+dpVIS+"\" "+divHelpi+"> <div  style=\"font-size: 115%; \">"+
                   val[0]+"</style></div><br><div style=\"font-size: 90%; \"> <div>"+bildHelper2+"</div>"+val[1]+"<br>"+val[4]+"</style></div>"+
                   " </div>"
  //setStateDelayed("javascript." + instance + ".Tabellen@Liv."+dpVIS+".HTMLTableVis", myFlexer ,1000);  "<br> "+val[3]+   "<br> "+val[5]+
  //log(htmlOut)
   }

 function flexboxFinish(){
 var htmlUeber=    "<p  class=\"divWeiten"+dpVIS+"\" style=\"color:"+htmlFarbUber+"; font-family:"+htmlSchriftart+"; font-size: "+htmlUEberFontGroesse+"; font-weight:"+htmlSchriftWeite+ "\">"+htmlFeldUeber+"&ensp;&ensp;Last Update: "+formatDate(getDateObject((new Date().getTime())), 'SS:mm:ss')+"</p>"; 
         if(mitSearch) htmlUeber=htmlUeber+searchMe
         var htmlUnter= "<div class=\"divWeiten"+dpVIS+"\" style=\"margin-top: 10px; color:"+htmlFarbUber+"; height: 30px; font-family:"+htmlSchriftart+"; font-size: 85%; text-align: center;\" >"+htmlFeldUeber+"&ensp;&ensp;Last Update: "+formatDate(getDateObject((new Date().getTime())), "SS:mm:ss");"</div>";
 
    var htmlOutVIS="";
              if (htmlUberschrift) 
                 { zentriert ? htmlOutVIS=htmlZentriert+htmlUeber+htmlTabStyle+htmlTabUeber+htmlOut+"</div></div></div>"+htmlUnter+"</center>"+ buttonScript : htmlOutVIS=htmlUeber+htmlTabStyle+htmlTabUeber+htmlOut+"</div></div></div>"+htmlUnter+"</center>"+ buttonScript ;
             } else {
                zentriert ?  htmlOutVIS=htmlZentriert+htmlTabStyle+htmlTabUeber+htmlOut+"</div></div></div>"+htmlUnter+"</center>"+ buttonScript :  htmlOutVIS=htmlTabStyle+htmlTabUeber+htmlOut+"</div></div></div>"+htmlUnter+"</center>"+ buttonScript;
             }
  
  setStateDelayed("javascript." + instance + ".Tabellen@Liv."+dpVIS+".HTMLTableVis", htmlOutVIS ,1000);
  setStateDelayed("javascript." + instance + ".Tabellen@Liv."+dpVIS+".Aktiv", aktiv ,1500);
            setStateDelayed("javascript." + instance + ".Tabellen@Liv."+dpVIS+".Inaktiv", inaktiv ,1500);
             setStateDelayed("javascript." + instance + ".Tabellen@Liv."+dpVIS+".Geamtanzahl", aktiv+inaktiv ,1500);

 }
let noon=false;
async function needDP(){
    for(let s=0;s<schalterInSpaltenUeberschrift.length;s++){ if(schalterInSpaltenUeberschrift[s]){
    if (!(await existsStateAsync("javascript." + instance + ".Tabellen@Liv."+dpVIS+".Spalte"+s))) {
        await createStateAsync("Tabellen@Liv."+dpVIS+".Spalte"+s, false,{type: "boolean", name: "Schalter_Spalte"+s, role: "value", read: true, write: true, } ); } 
      }}

    if (!(await existsStateAsync("javascript." + instance + ".Tabellen@Liv."+dpVIS+".HTMLTableVis"))) {
        await createStateAsync("Tabellen@Liv."+dpVIS+".HTMLTableVis", "empty",{type: "string", name: "HTML_Standard_Widget_mit_Binding", role: "value", read: true, write: true, } ); } 
     if (!(await existsStateAsync("javascript." + instance + ".Tabellen@Liv."+dpVIS+".JSONVis"))) {
        await createStateAsync("Tabellen@Liv."+dpVIS+".JSONVis", "",{type: "string", name: "JSON Format", role: "value", read: true, write: true, } ); }   
    if (!(await existsStateAsync("javascript." + instance + ".Tabellen@Liv."+dpVIS+".HostDaten"))) {
        await createStateAsync("Tabellen@Liv."+dpVIS+".HostDaten", "",{type: "string", name: "Host Daten", role: "value", read: true, write: true, } ); }   
    if (!(await existsStateAsync("javascript." + instance + ".Tabellen@Liv."+dpVIS+".IPDevices_MD_Table"))) {
        await createStateAsync("Tabellen@Liv."+dpVIS+".IPDevices_MD_Table", "",{type: "string", name: "IPDevices MD Table MD", role: "value", read: true, write: true, } ); } 
     if (!(await existsStateAsync("javascript." + instance + ".Tabellen@Liv."+dpVIS+".IPDevices_MD_List"))) {
        await createStateAsync("Tabellen@Liv."+dpVIS+".IPDevices_MD_List", "",{type: "string", name: "IPDevices MD List MD", role: "value", read: true, write: true, } ); } 
     if (!(await existsStateAsync("javascript." + instance + ".Tabellen@Liv."+dpVIS+".Aktiv"))) {
        await createStateAsync("Tabellen@Liv."+dpVIS+".Aktiv", 0,{type: "number", name: "activ Devices", role: "value", read: true, write: true, } ); }      
    if (!(await existsStateAsync("javascript." + instance + ".Tabellen@Liv."+dpVIS+".Inaktiv"))) {
        await createStateAsync("Tabellen@Liv."+dpVIS+".Inaktiv", 0,{type: "number", name: "inactive Devices", role: "value", read: true, write: true, } ); }
    if (!(await existsStateAsync("javascript." + instance + ".Tabellen@Liv."+dpVIS+".Geamtanzahl"))) {
        await createStateAsync("Tabellen@Liv."+dpVIS+".Geamtanzahl", 0,{type: "number", name: "Geamtanzahl Devices", role: "value", read: true, write: true, } ); }    
}

   setTimeout(function () { 

    let arrTriggerSchalter=[]
    $("javascript." + instance + ".Tabellen@Liv."+dpVIS+".Spalte*").each(function(id, i) {  
           arrTriggerSchalter.push(id) 
    });
  //  log(arrTriggerSchalter.toString())
    on({id: arrTriggerSchalter, ack: false, change: "any"}, function (obj) { 
        
        if(!noon) { // wegen sonderTablet schaltet spalte 7 und 5 - 5 wird geblockt
        noon=true;//log(obj.id)
      if (obj.id=="javascript." + instance + ".Tabellen@Liv."+dpVIS+".Spalte0")   mysortiereClient=1;
      if (obj.id=="javascript." + instance + ".Tabellen@Liv."+dpVIS+".Spalte1" )  mysortiereClient=2 ;
      if (obj.id=="javascript." + instance + ".Tabellen@Liv."+dpVIS+".Spalte2" )  mysortiereClient=3; 
      if (obj.id=="javascript." + instance + ".Tabellen@Liv."+dpVIS+".Spalte3" )  mysortiereClient=4; //kat
      if (obj.id=="javascript." + instance + ".Tabellen@Liv."+dpVIS+".Spalte4")   mysortiereClient=5; //mac
      if (obj.id=="javascript." + instance + ".Tabellen@Liv."+dpVIS+".Spalte5")   flexboxView=flexboxView;
      if (obj.id=="javascript." + instance + ".Tabellen@Liv."+dpVIS+".Spalte6" )  flexboxView=!flexboxView;
      if (obj.id=="javascript." + instance + ".Tabellen@Liv."+dpVIS+".Spalte7" )  flexboxView=!flexboxView;
      
  //    if (obj.id=="javascript." + instance + ".Tabellen@Liv."+dpVIS+".Spalte5")   welcheSortierung=5;
  //    if (obj.id=="javascript." + instance + ".Tabellen@Liv."+dpVIS+".Spalte6" )  welcheSortierung=6; 

     
      
    //  log(String(mehrfachTabelle))
   setTimeout(function () {  noon=false; 
     if(!laeuftSchon) { obj.id=="javascript." + instance + ".Tabellen@Liv."+dpVIS+".Spalte5" ?  writeHTML(true) : writeHTML(false);}
      //  if (braucheEinFile) {writeFile(home, path ,htmlOut, function (error) { /* log('file written');*/  });}
}, 300);
        }  
 
      
    });}, 50);


//SORTIEREN
function sortMe(myType,value){

if(myType=="alpha" ){ myObject.sort(function (alpha, beta) {
             if ((alpha[value].toString().toUpperCase()).trim() > (beta[value].toString().toUpperCase()).trim())
                return 1;
             if ((beta[value].toString().toUpperCase()).trim()> (alpha[value].toUpperCase().toString()).trim())
                return -1;
             return 0;
            });}
 if(myType=="bool" ) {
      
   myObject .sort(function(x, y) { return x[value] - y[value] }); }       
 
 
   if(myType=="num" )   { myObject.sort(function (alpha, beta) {
                      return  beta[value] -alpha[value];   });}

}


function makeMyCSS() {

    trHelperClass=" ";
for (let jj=0;jj<(Feld1lAlign.length)*mehrfachTabelle;jj++) {  
        trHelperClass= trHelperClass+ " .scrollContent"+dpVIS+" td"+":nth-of-type("+(jj+1)+") {width: "+htmlSpalte1Weite[jj]+"; text-align: "+Feld1lAlign[jj]+" }"
  }
  //log(trHelperClass)
switch (bkgroundSearch){
    case 1 :   bkgDiv=`background:
                       radial-gradient(black 15%, transparent 16%) 0 0,
                       radial-gradient(black 15%, transparent 16%) 8px 8px,
                       radial-gradient(rgba(255,255,255,.1) 15%, transparent 20%) 0 1px,
                       radial-gradient(rgba(255,255,255,.1) 15%, transparent 20%) 8px 9px;
                       background-color:#282828;
                       background-size:16px 16px;`; break;

   case 2 : bkgDiv=`background:
                    url(data:image/gif;base64,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)`
                   ; break

   case 3 : bkgDiv=`background:
                    radial-gradient(rgba(255,255,255,0) 0, rgba(255,255,255,.15) 30%, rgba(255,255,255,.3) 32%, rgba(255,255,255,0) 33%) 0 0,
                    radial-gradient(rgba(255,255,255,0) 0, rgba(255,255,255,.1) 11%, rgba(255,255,255,.3) 13%, rgba(255,255,255,0) 14%) 0 0,
                    radial-gradient(rgba(255,255,255,0) 0, rgba(255,255,255,.2) 17%, rgba(255,255,255,.43) 19%, rgba(255,255,255,0) 20%) 0 110px,
                    radial-gradient(rgba(255,255,255,0) 0, rgba(255,255,255,.2) 11%, rgba(255,255,255,.4) 13%, rgba(255,255,255,0) 14%) -130px -170px,
                    radial-gradient(rgba(255,255,255,0) 0, rgba(255,255,255,.2) 11%, rgba(255,255,255,.4) 13%, rgba(255,255,255,0) 14%) 130px 370px,
                    radial-gradient(rgba(255,255,255,0) 0, rgba(255,255,255,.1) 11%, rgba(255,255,255,.2) 13%, rgba(255,255,255,0) 14%) 0 0,
                    linear-gradient(45deg, #343702 0%, #184500 20%, #187546 30%, #006782 40%, #0b1284 50%, #760ea1 60%, #83096e 70%, #840b2a 80%, #b13e12 90%, #e27412 100%);
                    background-size: 470px 470px, 970px 970px, 410px 410px, 610px 610px, 530px 530px, 730px 730px, 100% 100%;
                    background-color: #840b2a;`; break;

   case 4 : bkgDiv=`background: radial-gradient(${htmlFarbTableColorGradient1}, ${htmlFarbTableColorGradient2});`; break;   //265686 5590CA 2F2F2F 3c3c3c
   case 5 : bkgDiv=`background: radial-gradient(${farbeUngeradeZeilen}, ${farbeGeradeZeilen});`; break;   //265686 5590CA 2F2F2F 3c3c3c

   case 6 : bkgDiv=`background: radial-gradient(#bfbcbc, #ffffff);`; break;   //265686 5590CA 2F2F2F 3c3c3c


}

 scrollBar=` .thescroller${dpVIS}::-webkit-scrollbar { width: 5px;}
.thescroller${dpVIS}::-webkit-scrollbar-track {background: transparent; width: 5px;}
.thescroller${dpVIS}::-webkit-scrollbar-thumb {border-radius: 40px; border: transparent ; background: ${htmlFarbTableColorGradient1}; }
.thescroller${dpVIS} {scrollbar-width: thin; scrollbar-color: ${htmlFarbTableColorGradient1} transparent;}}`

myButtonUeberschrift=" .myButt"+dpVIS+" {border-radius: 4px; border:"+schalterUmrahmung+"px solid; background-color: "+htmlBackgroundButtonUeberschrift+"\; color: "+htmlFarbTableColorUber+"; font-family: "+htmlSchriftart+"; font-size :"+groesseUeberschrift+"px; text-align:left;}"


           htmlZentriert=   "<style>"+                       // <meta name=\"viewport\" content=\"width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no\" />
            /*weite*/          " .divWeiten"+dpVIS+" {  width: "+weite+"px }"+
            /*thead*/          " .fixedHeader"+dpVIS+" {position: -webkit-sticky;  position: sticky;  top: 0px ; overflow-y:scroll; overflow-x: hidden; width: 100%;  height: "+UeberSchriftHoehe+"px; border-bottom: "+LinieUnterUeberschrift+"px solid "+farbeLinieUnterUeberschrift+";"+
                                               " font-family:"+htmlSchriftart+"\;  color:"+htmlFarbTableColorUber+"; "+  //  border-spacing:"+abstandZelle+"px;
                                               " font-size: "+groesseUeberschrift+"px; font-weight: "+UeberschriftStyle+";  background-image: linear-gradient("+htmlGragient[0]+"deg,"+htmlFarbTableColorGradient2+" "+htmlGragient[1]+"%,"+htmlFarbTableColorGradient1+" "+htmlGragient[2]+"%); }"+ //
            /*tbody */         " .scrollContent"+dpVIS+" { width: 100%; overflow-y: scroll;  }"+ // height: "+hoeheTabelle2+"px; 
                               
                               " .scrollContent"+dpVIS+" td {padding: "+abstandZelle+"px; }"+
            /*div*/            " .tableContainer"+dpVIS+" {  display: flex; flex-direction: column;  height: "+hoeheTabelle+"px; width: "+weite+"px; overflow-y:auto; overflow-x: hidden ; "
                                                          +bkgDiv+" }"+  // position: sticky; top: 0; background-color: black;
            /*seitenl*/        " .seitenleiste"+dpVIS+" { background-image: linear-gradient("+htmlGragient[0]+"deg,"+htmlFarbTableColorGradient2+" "+htmlGragient[1]+"%,"+htmlFarbTableColorGradient1+" "+htmlGragient[2]+"%); color: " //background-color: "+htmlBackgroundFarbeSeitenliste+";
                                                          +htmlFarbTableColorUber+ ";font-size:"+schriftGroesseSeitenleiste+"px; vertical-align:top; text-align:center; width: "+breiteSeitenleiste+"px}"+  //margin-top: 30px;
                               " .flexContainer"+dpJSON+" {display: flex; width: "+weite+"px}"+                        
            /*table*/          " .tablezusatz"+dpVIS+" {  border:"+rahmenBreite+";  "+  //table-layout: fixed;
                                              "width:100%; color:"+htmlFarbFelderschrift+";  font-size:"+htmlSchriftgroesse+";"+
                                              "font-family:"+htmlSchriftart+"; background-image: linear-gradient("+htmlGragient[0]+"deg,"+htmlFarbTableColorGradient2+" "+htmlGragient[1]+"%,"+htmlFarbTableColorGradient1+" "+htmlGragient[2]+"%); }"+
                               " .mythclass0"+dpVIS+" {    }"+  //text-align:"+Feld1lAlign[0]+"
                               " .mythclass1"+dpVIS+" {   }"+
                               " .mythclass2"+dpVIS+" {   }"+
                               " .mythclass3"+dpVIS+" {  }"+
                               " .mythclass4"+dpVIS+" {  }"+
                               " .mythclass5"+dpVIS+" {  }"+
                               " .mythclass6"+dpVIS+" {   }"+ 
                               " .divFlexBoxen"+dpVIS+" {  overflow-y: scroll; display: flex; flex-direction: row; flex-wrap: wrap; width: 100%; height: "+(hoeheTabelle-(Number(UeberSchriftHoehe)))+"px;  align-items: center; justify-content: center; }"+  //height: "+(hoeheTabelle-(Number(UeberSchriftHoehe)))+"px;
                               " .divFlexBoxenEinzeln"+dpVIS+" { padding: 20px; color: "+htmlFarbFelderschrift+"; border: 2px solid; border-radius: 25px; width: auto; height: auto; border-color: "+htmlFarbFelderschrift+"; margin: 10px;}"+
                               " .divInFlex"+dpVIS+" {  background-image: linear-gradient("+htmlGragient[0]+"deg,"+htmlFarbTableColorGradient2+" 10%,"+htmlFarbTableColorGradient1+" 20%); }"+ //  "+htmlGragient[1]+"   "+htmlGragient[2]+" 
                               " .emptyFlex2_1"+dpVIS+" { color: transparent; background-image: none !important; background-color: "+htmlFarbTableColorGradient1+" !important;}"+
                             //  " th {position: sticky; top: 0px ; height: "+UeberSchriftHoehe+"px; background-image: linear-gradient("+htmlGragient[0]+"deg,"+htmlFarbTableColorGradient2+" "+htmlGragient[1]+"%,"+htmlFarbTableColorGradient1+" "+htmlGragient[2]+"%); }"+  //position: sticky; top: 0px ;
                               " .myclassueber_spalte_button     {color:"+htmlFarbTableColorUber+"}"+
                               " .myclassueber_spalte_ohne_button{color:"+htmlFarbTableColorUber+"}"+
                               " .myTHclass"+dpVIS+" { position: -webkit-sticky; position: sticky;  top: 0px ; height: "+UeberSchriftHoehe+"px; background-image: linear-gradient("+htmlGragient[0]+"deg,"+htmlFarbTableColorGradient2+" "+htmlGragient[1]+"%,"+htmlFarbTableColorGradient1+" "+htmlGragient[2]+"%);}"+
                               " .myTRclass"+dpVIS+" {position: -webkit-sticky;  position: sticky;  top: 0px ;}"+
                               " .myclasstr_gerade"+dpVIS+" { height:"+zeilenAbstand+"px; background-color:"+farbeGeradeZeilen+"}"+  //border-spacing:"+abstandZelle+"px; 
                               " .myclasstr_ungerade"+dpVIS+" {  height:"+zeilenAbstand+"px;  background-color:"+farbeUngeradeZeilen+"}"+ //border-spacing:"+abstandZelle+"px;
                               " .myclasstd_normal"+dpVIS+" {}"+
                               " .myclasstd_trennungslinie"+dpVIS+" {}"+
                               " .mySpan"+dpVIS+" {color: " +htmlFarbTableColorUber+"; font-family: "+htmlSchriftart+"; font-size :"+groesseUeberschrift+"px; font-weight: normal;}"+
                               " .myinputclass"+dpVIS+" {width: "+weite+"px; border: 1px solid; border-color: "+htmlFarbTableColorGradient2+"; margin-bottom: 15px;  color: "+htmlFarbTableColorUber+
                                                        "; height: "+sucheHoehe+"px; background-image: linear-gradient("+htmlGragient[0]+"deg,"+htmlFarbTableColorGradient2+" "+htmlGragient[1]+"%,"+htmlFarbTableColorGradient1+" "+
                                                        htmlGragient[2]+"%); font-family:"+htmlSchriftart+"\; font-size: 110%; color: "+htmlFarbTableColorUber+"}"+
                            trHelperClass+scrollBar+ //myButtonUeberschrift+
                          //     " .thescroller"+dpVIS+"::-webkit-scrollbar {width: 0px; }"+
                               "</style>"+'<center>'

}// endCSS



function makeMySearch_Seitenleiste() {

 

   einmalAbstand=`<br>
`
  let seitenLeistenTest=symbolSchalter[3];
  for (let f=0;f<abstandSeitentextVonOben;f++){ 
      seitenLeistenTest=seitenLeistenTest+`<br>
`}

  for (let i=0;i<nameSeitenLeiste.length;i++){
      seitenLeistenTest=seitenLeistenTest+nameSeitenLeiste[i]+`<br>
`
 }
 if (tabletDoppelHilfe) seitenLeistenTest=seitenLeistenTest+einmalAbstand+ einmalAbstand+"<div class=\"sonderTablet"+dpVIS+"\"> "+symbolSchalter[4]+"</div>"

  htmlSeitenleiste="";
  if (ichWillSeitenLeiste) htmlSeitenleiste= "<div class=\"flexContainer"+dpJSON+"\"> <div class=\"seitenleiste"+dpVIS+"\">"+seitenLeistenTest+"</div>" ;// htmlTabUeber1=htmlTabUeber1+
searchMe="";
sucheEin ? searchMe="<div class=\"divWeiten"+dpVIS+"\"><input class=\"myinputclass"+dpVIS+"\" type=\"search\" id=\"search"+dpVIS+"\" placeholder=\"Filter by Item\""+">"+"</div>" :
           searchMe=""     
searchMe=searchMe+htmlSeitenleiste
htmlTabStyle= "<div class=\"tableContainer"+dpVIS+" thescroller"+dpVIS+"\" >"+
                    "<table class=\"tablezusatz"+dpVIS+"\" rules=\""+htmlRahmenLinien+"\">"+
                    "<thead class=\"fixedHeader"+dpVIS+"\">"
                

htmlTabUeber4="<tr class=\"myTRclass"+dpVIS+"\">";
}



function makeMyVisScripte() {

     let valSpalte=[] ;
    for(let kk=0;kk<val.length;kk++){
      valSpalte.push(val[kk])
    }

    let spaltenAnzeigeScript=`$(document).ready(function() { `
    let spaltenAnzeigeScriptEnd=` });` ;
for (let ff=0;ff<(valSpalte.length);ff++){
                                        // log(valSpalte[ff]); 
                                         if (valSpalte[ff]=="false") { spaltenAnzeigeScript=spaltenAnzeigeScript.concat(`$('td:nth-child(${(ff+1)}).toDel${dpVIS},th:nth-child(${(ff+1)}).toDel${dpVIS}').hide();`) 
                                                                       if (mehrfachTabelle==2) {spaltenAnzeigeScript=spaltenAnzeigeScript.concat(`$('td:nth-child(${(ff+1+valSpalte.length)}).toDel${dpVIS},th:nth-child(${(ff+1+valSpalte.length)}).toDel${dpVIS}').hide();`) }
                                                                       if (mehrfachTabelle==3) {spaltenAnzeigeScript=spaltenAnzeigeScript.concat(`$('td:nth-child(${(ff+1+(2*valSpalte.length))}).toDel${dpVIS},th:nth-child(${(ff+1+(2*valSpalte.length))}).toDel${dpVIS}').hide();`) }                        
                                         }}

 buttonScript =   '<script> function setOnOtherValue(myval) {	var Self = this;	Self.servConn.getStates(myval, (error, states) => {  console.log(states); self.servConn.setState(myval, !states[myval].val);}  )}; '
                      + '$( "button.myButt'+dpVIS+'" ).click(function() {  $( this ).slideUp() ; setTimeout(function() { $( "button.myButt'+dpVIS+'" ).hide()  ; $( ".mySpan'+dpVIS+'" ).text(\"wait ...\")}, 500); });' //'[class*="test"]' [class~="value"]   "[class~='gerade']"
     /*search*/       + `var allRows = $("[class*='gerade${dpVIS}']");  $("input.myinputclass${dpVIS}").on("keydown keyup", function() {  allRows.hide();  $("tr:contains('" + $(this).val() + "')").show();});`
     /*search*/       + `var allRows2 = $("div.divFlexBoxenEinzeln${dpVIS}"); console.log(allRows2);  $("input.myinputclass${dpVIS}").on("keydown keyup", function() {  allRows2.hide();  $("div.divFlexBoxenEinzeln${dpVIS}:contains('" + $(this).val() + "')").show();});`
                      + `$( ".seitenleiste${dpVIS}:not(.seitenleiste${dpVIS}.sonderTablet${dpVIS})" ).click(function() { $( "button.myButt${dpVIS}" ).slideUp() ; setTimeout(function() { $( "button.myButt${dpVIS}" ).hide()  ; $( ".mySpan${dpVIS}" ).text(\"refresh\")}, 500); var Self = this; var myvali='javascript.${instance}.Tabellen@Liv.${dpVIS}.Spalte5'; vis.setValue(myvali,true) ; console.log("spalt5")   });`
                    //   + `$( ".seitenleiste${dpVIS}:not(.seitenleiste${dpVIS}.sonderTablet${dpVIS})" ).click(function() {var Self = this; var myvali='javascript.${instance}.Tabellen@Liv.${dpVIS}.Spalte5'; vis.setValue(myvali,true) ; console.log("spalt5")   });`
     /*dbclick*/      + `$( "[class*='gerade${dpVIS}']" ).dblclick(function() {var Self = this; var myvali='javascript.${instance}.Tabellen@Liv.${dpVIS}.Spalte6'; vis.setValue(myvali,true) ; console.log("spalt6")   });`
     /*dbclick*/      + `$( "[class*='divFlexBoxen${dpVIS}']" ).dblclick(function() {var Self = this; var myvali='javascript.${instance}.Tabellen@Liv.${dpVIS}.Spalte6'; vis.setValue(myvali,true); console.log("spalt6")   });`
     /*tablet       */+ `$( ".sonderTablet${dpVIS}" ).click(function() {var Self = this; var myvali='javascript.${instance}.Tabellen@Liv.${dpVIS}.Spalte7'; vis.setValue(myvali,true); console.log("spalt7")   });`
                      +   spaltenAnzeigeScript  +  spaltenAnzeigeScriptEnd  
                      +'</script>'


}


  function makeJsonWidget(vax1,vax2,vax3,vax4,vax5,vax6) {
//log(vax3+vax6+htmlFeld1)
 vax4=pfadFuerBilder+vax4+".png" ;
    if ( braucheMaterialDesignWidgetList) {
    myJsonWidget.push({
        Device : vax4,
        IP : vax1,
        Status : vax2,
        Kategorie : vax3+" "+vax6
    }

    );}

//	log(myJsonWidget)
 if (braucheMaterialDesignWidget) {
     let colorIP= materialD_IP_erreichbar   //"lightgreen";
   //  log(vax3)
     if (vax3==symbolSchalter[2]) colorIP=materialD_IP_nichtErreichbar     //"lightcoral";
   //  vax4=pfadFuerBilder+vax4+".png" ; 
let mysubText = `<div style="display: flex; flex-direction: row; line-height: 1.3; padding-left: 1px; padding-right: 8px; align-items: center;">
                               <div style="flex: 1;font-size: 16px; color: ${colorIP};">${vax2}</div>
                               <div style="color: grey; font-size: 12px; font-family: RobotoCondensed-LightItalic; text-align: right;">${vax3}${vax6}</div>
                           </div>`
      let ip=vax2                     
   
      myJsonWidget2.push({
                text: vax1,
                subText: mysubText,
                statusBarColor: vax5,
                image: vax4,
                imageColor: "",
                listType: "text",
                showValueLabel: true,
                ip: ip, //vax2,
                status: vax3,
                link:vax6
                
            });
 }
  }

  

 async function needDP2(myData){
     if (!(await existsStateAsync("Tabellen@Liv."+dpVIS+".Device_Collection"))) {
        await createStateAsync("Tabellen@Liv."+dpVIS+".Device_Collection", myData,{type: "array", name: "Device_Collection", desc: 'Device_Collection', role: "value", read: true, write: true, } ); }
     }

 async function getData(myData){
      return getState(myData).val; 
 }
 
function Sleep(milliseconds) {
 return new Promise(resolve => setTimeout(resolve, milliseconds));
}









